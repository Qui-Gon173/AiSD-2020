# Лабораторная работа №5

## Задание:

Требуется реализовать алгоритм внешней сортировки методом простого слияния. Для упрощения реализации алгоритма разрешается использовать STL коллекции. Создайте текстовый файл, содержащий набор значений для сортировки, и реализуйте сортировку данных файла данным алгоритмом. Запрещается загружать полностью в память данные файлы.

## Реализация:

```c++
#include <iostream>
#include <algorithm>
#include <queue>
#include <limits>
#include <fstream>
using namespace std;
//Описание функции сортировки простым слиянием
void Simple_Merging_Sort(char* name) {
    int a1, a2, k, i, j, kol, tmp;
    fstream f;
    f.open(name, fstream::in);
    kol = -1;
    if (!f)
    {
        cout << "Not good";
    }
    else {
        while (f) {
            f >> a1;
            kol++;
        }
        f.close();
    }
    k = 1;
  
    while (k < kol) {
        f.open(name, fstream::in);
        fstream f1;
        f1.open("smsort_1.txt", fstream::out);
        fstream f2;
        f2.open("smsort_2.txt", fstream::out);
        if (f) f >>a1;
        while (f) {
            for (i = 0; i < k && f; i++) {
                f1 << a1 << endl;
                f >> a1;
            }
            for (j = 0; j < k && f; j++) {

                f2 << a1 << endl;
                f >> a1;
            }
        }
        f1.close();
        f.close();
        f2.close();


        f.open(name, fstream::out);
        f1.open("smsort_1.txt", fstream::in);
        f2.open("smsort_2.txt", fstream::in);

        if (f1) f1 >> a1;
        if (f2) f2 >> a2;
        while (f1 && f2) {
            i = 0;
            j = 0;
            while (i < k && j < k && f1 && f2) {
                if (a1 < a2) {
                    f << a1 <<endl;
                   f1 >> a1;
                    i++;
                }
                else {
                    f << a2 <<endl;
                    f2 >> a2;
                    j++;
                }
            }
            while (i < k && f1) {
                f << a1 <<endl;
                f1>>a1;
                i++;
            }
            while (j < k && f2) {
                f << a2 <<endl;
               f2 >>a2;
                j++;
            }
        }
       

        while (f1) {
            f << a1 <<endl;
            f1 >> a1;

        }
        while (f2) {
            f << a2 <<endl;
            f2 >> a2;
        }
        f2.close();
        f1.close();
        f.close();
        k *= 2;
}
}
int main()
{
    char name[] = "myFile.txt";
    Simple_Merging_Sort(name);
    cout << "Good!";

    return 0;
}
```

## Оветы на вопросы:

### 1. Что называется внешней сортировкой
Внешняя сортировка – это сортировка данных, которые расположены на внешних устройствах и не вмещающихся в оперативную память.

Данные, хранящиеся на внешних устройствах, имеют большой объем, что не позволяет их целиком переместить в оперативную память, отсортировать с использованием одного из алгоритмов внутренней сортировки, а затем вернуть их на внешнее устройство. В этом случае осуществлялось бы минимальное количество проходов через файл, то есть было бы однократное чтение и однократная запись данных. Однако на практике приходится осуществлять чтение, обработку и запись данных в файл по блокам, размер которых зависит от операционной системы и имеющегося объема оперативной памяти, что приводит к увеличению числа проходов через файл и заметному снижению скорости сортировки.

### 2. На основе каких процедур основываются алгоритмы внешней сортировки

В основе большинства методов внешних сортировок лежит процедура слияния и процедура распределения. Слияние – это процесс объединения двух (или более) упорядоченных серий в одну упорядоченную последовательность при помощи циклического выбора элементов, доступных в данный момент. Распределение – это процесс разделения упорядоченных серий на два и несколько вспомогательных файла.

### 3. Раскройте определения характеристик алгоритмов: Распределение, Слияние, Серия, Фаза, Виды слияния (двухпутевое и многопутевое)

* Слияние – это процесс объединения двух (или более) упорядоченных серий в одну упорядоченную последовательность при помощи циклического выбора элементов, доступных в данный момент. 
* Распределение – это процесс разделения упорядоченных серий на два и несколько вспомогательных
* Серия (упорядоченный отрезок) – это последовательность элементов, которая упорядочена по ключу.
* Фаза – это действия по однократной обработке всей последовательности элементов. 
* Двухпутевое слияние – это сортировка, в которой отдельно реализуется две фазы: распределение и слияние. 
* Многопутевое слияние - сортировка, в которой данные распределяются на N (N > 2) вспомогательных файлов.

### 4. Опишите, какими характеристиками обладает алгоритм простого слияния

* количество фаз в реализации сортировки;
* количество вспомогательных файлов, на которые распределяются серии.